# IDA Pro MCP vs SO Analyzer MCP å·¥å…·å¯¹æ¯”

## IDA Pro MCP å·¥å…·åˆ—è¡¨ (å…± 45+ ä¸ªå·¥å…·)

### ğŸ“Š åŸºç¡€ä¿¡æ¯ (5ä¸ª)
| å·¥å…· | åŠŸèƒ½ | so-analyzer å¯¹åº” | çŠ¶æ€ |
|------|------|------------------|------|
| `idb_meta` | è·å–IDBå…ƒæ•°æ® | `so_info` | âœ… æœ‰ |
| `cursor_addr` | è·å–å½“å‰åœ°å€ | âŒ | âŒ æ—  |
| `cursor_func` | è·å–å½“å‰å‡½æ•° | âŒ | âŒ æ—  |
| `segments` | åˆ—å‡ºæ‰€æœ‰æ®µ | `so_get_sections` | âœ… æœ‰ |
| `entrypoints` | è·å–å…¥å£ç‚¹ | âŒ | âŒ æ—  |

### ğŸ” å‡½æ•°åˆ†æ (8ä¸ª)
| å·¥å…· | åŠŸèƒ½ | so-analyzer å¯¹åº” | çŠ¶æ€ |
|------|------|------------------|------|
| `list_funcs` | åˆ—å‡ºæ‰€æœ‰å‡½æ•° | `so_list_all_functions` | âœ… å·²å®ç° |
| `lookup_funcs` | æŸ¥æ‰¾å‡½æ•° | `so_search_symbol` | âœ… æœ‰ |
| **`decompile`** | **åç¼–è¯‘å‡½æ•°** | `so_decompile` | âœ… å·²å®ç° |
| `disasm` | åæ±‡ç¼–å‡½æ•° | `so_disassemble` | âœ… æœ‰ |
| `analyze_funcs` | ç»¼åˆåˆ†æå‡½æ•° | `so_analyze_function_advanced` | âœ… å·²å¢å¼º |
| `callees` | è·å–è¢«è°ƒç”¨å‡½æ•° | `so_callgraph` | âœ… å·²å®ç° |
| `callers` | è·å–è°ƒç”¨è€… | `so_callgraph` | âœ… å·²å®ç° |
| `callgraph` | æ„å»ºè°ƒç”¨å›¾ | `so_callgraph` | âœ… å·²å®ç° |

### ğŸ”— äº¤å‰å¼•ç”¨ (3ä¸ª)
| å·¥å…· | åŠŸèƒ½ | so-analyzer å¯¹åº” | çŠ¶æ€ |
|------|------|------------------|------|
| `xrefs_to` | è·å–äº¤å‰å¼•ç”¨ | `so_xref_string` | âœ… æœ‰ |
| `xrefs_to_field` | ç»“æ„ä½“å­—æ®µå¼•ç”¨ | âŒ | âŒ æ—  |
| `xref_matrix` | äº¤å‰å¼•ç”¨çŸ©é˜µ | âŒ | âŒ æ—  |

### ğŸ“ å­—ç¬¦ä¸²å’Œæ•°æ® (5ä¸ª)
| å·¥å…· | åŠŸèƒ½ | so-analyzer å¯¹åº” | çŠ¶æ€ |
|------|------|------------------|------|
| `strings` | åˆ—å‡ºå­—ç¬¦ä¸² | `so_strings` | âœ… æœ‰ |
| `imports` | åˆ—å‡ºå¯¼å…¥ | `so_imports` | âœ… æœ‰ |
| `list_globals` | åˆ—å‡ºå…¨å±€å˜é‡ | âŒ | âŒ æ—  |
| `get_global_value` | è¯»å–å…¨å±€å˜é‡å€¼ | âŒ | âŒ æ—  |
| `int_convert` | æ•°å­—æ ¼å¼è½¬æ¢ | âŒ | âŒ æ—  |

### ğŸ” æœç´¢åŠŸèƒ½ (4ä¸ª)
| å·¥å…· | åŠŸèƒ½ | so-analyzer å¯¹åº” | çŠ¶æ€ |
|------|------|------------------|------|
| `search` | æœç´¢æ¨¡å¼ | `so_search_bytes` | âœ… æœ‰ |
| `find_bytes` | æŸ¥æ‰¾å­—èŠ‚ | `so_search_bytes` | âœ… æœ‰ |
| `find_insns` | æŸ¥æ‰¾æŒ‡ä»¤åºåˆ— | âŒ | âŒ æ—  |
| `find_insn_operands` | æŸ¥æ‰¾æŒ‡ä»¤æ“ä½œæ•° | âŒ | âŒ æ—  |
| `find_paths` | æŸ¥æ‰¾æ‰§è¡Œè·¯å¾„ | âŒ | âŒ æ—  |

### ğŸ“¦ ç±»å‹ç³»ç»Ÿ (7ä¸ª)
| å·¥å…· | åŠŸèƒ½ | so-analyzer å¯¹åº” | çŠ¶æ€ |
|------|------|------------------|------|
| `local_types` | åˆ—å‡ºæœ¬åœ°ç±»å‹ | âŒ | âŒ æ—  |
| `structs` | åˆ—å‡ºç»“æ„ä½“ | âŒ | âŒ æ—  |
| `struct_info` | è·å–ç»“æ„ä½“ä¿¡æ¯ | âŒ | âŒ æ—  |
| `read_struct` | è¯»å–ç»“æ„ä½“å­—æ®µ | âŒ | âŒ æ—  |
| `declare_type` | å£°æ˜ç±»å‹ | âŒ | âŒ æ—  |
| `apply_types` | åº”ç”¨ç±»å‹ | âŒ | âŒ æ—  |
| `infer_types` | æ¨æ–­ç±»å‹ | âŒ | âŒ æ—  |

### ğŸ”§ ä¿®æ”¹æ“ä½œ (6ä¸ª)
| å·¥å…· | åŠŸèƒ½ | so-analyzer å¯¹åº” | çŠ¶æ€ |
|------|------|------------------|------|
| `patch` | Patchå­—èŠ‚ | `so_patch_bytes` | âœ… æœ‰ |
| `patch_asm` | Patchæ±‡ç¼– | âŒ | âŒ æ—  |
| `rename` | é‡å‘½å | âŒ | âŒ æ—  |
| `set_comments` | è®¾ç½®æ³¨é‡Š | âŒ | âŒ æ—  |
| `export_funcs` | å¯¼å‡ºå‡½æ•°æ•°æ® | âŒ | âŒ æ—  |
| `basic_blocks` | è·å–åŸºæœ¬å— | `so_get_cfg` | âœ… å·²å®ç° |

### ğŸ› è°ƒè¯•å™¨ (13ä¸ª)
| å·¥å…· | åŠŸèƒ½ | so-analyzer å¯¹åº” | çŠ¶æ€ |
|------|------|------------------|------|
| `dbg_start` | å¯åŠ¨è°ƒè¯•å™¨ | âŒ | âŒ æ—  |
| `dbg_exit` | é€€å‡ºè°ƒè¯•å™¨ | âŒ | âŒ æ—  |
| `dbg_continue` | ç»§ç»­æ‰§è¡Œ | âŒ | âŒ æ—  |
| `dbg_step_into` | å•æ­¥è¿›å…¥ | âŒ | âŒ æ—  |
| `dbg_step_over` | å•æ­¥è·³è¿‡ | âŒ | âŒ æ—  |
| `dbg_run_to` | è¿è¡Œåˆ°åœ°å€ | âŒ | âŒ æ—  |
| `dbg_add_bp` | æ·»åŠ æ–­ç‚¹ | âŒ | âŒ æ—  |
| `dbg_delete_bp` | åˆ é™¤æ–­ç‚¹ | âŒ | âŒ æ—  |
| `dbg_list_bps` | åˆ—å‡ºæ–­ç‚¹ | âŒ | âŒ æ—  |
| `dbg_regs` | è·å–å¯„å­˜å™¨ | âŒ | âŒ æ—  |
| `dbg_read_mem` | è¯»å–è°ƒè¯•å†…å­˜ | âŒ | âŒ æ—  |
| `dbg_write_mem` | å†™å…¥è°ƒè¯•å†…å­˜ | âŒ | âŒ æ—  |
| `dbg_callstack` | è·å–è°ƒç”¨æ ˆ | âŒ | âŒ æ—  |

### ğŸ Python æ‰§è¡Œ
| å·¥å…· | åŠŸèƒ½ | so-analyzer å¯¹åº” | çŠ¶æ€ |
|------|------|------------------|------|
| `py_eval` | æ‰§è¡ŒPythonä»£ç  | âŒ | âŒ æ—  |

---

## ç»Ÿè®¡å¯¹æ¯”

| ç±»åˆ« | IDA Pro MCP | so-analyzer | å·®è· |
|------|-------------|-------------|------|
| **æ€»å·¥å…·æ•°** | 45+ | 30 | -15 |
| **åŸºç¡€åˆ†æ** | 5 | 8 | +3 âœ… |
| **å‡½æ•°åˆ†æ** | 8 | 8 | 0 âœ… |
| **äº¤å‰å¼•ç”¨** | 3 | 4 | +1 âœ… |
| **å­—ç¬¦ä¸²/æ•°æ®** | 5 | 3 | -2 âŒ |
| **æœç´¢åŠŸèƒ½** | 5 | 3 | -2 âŒ |
| **ç±»å‹ç³»ç»Ÿ** | 7 | 0 | -7 âŒ |
| **ä¿®æ”¹æ“ä½œ** | 6 | 4 | -2 âŒ |

---

## å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½ 

### ä¼˜å…ˆçº§ 1 - å·²å®Œæˆ

#### 1. åç¼–è¯‘ (`so_decompile`) 
```python
so_decompile(so_path, address, method="radare2")  # æˆ– "ghidra" / "simple"
# è¿”å›: ä¼ªä»£ç å­—ç¬¦ä¸²
```
æ”¯æŒä¸‰ç§æ¨¡å¼: radare2(é»˜è®¤), Ghidra(é«˜è´¨é‡), simple(æ— ä¾èµ–)

#### 2. å‡½æ•°åˆ—è¡¨ (`so_list_all_functions`) 
```python
so_list_all_functions(so_path, limit=2000, search="ssl")
# è¿”å›: æ‰€æœ‰å‡½æ•°ï¼ˆåŒ…æ‹¬æœªå¯¼å‡ºçš„ï¼‰
```
é€šè¿‡æ‰«æ PACIBSP/STP X29,X30 ç­‰å‡½æ•°å¼€å¤´ç‰¹å¾è¯†åˆ«

### ä¼˜å…ˆçº§ 2 - å·²å®Œæˆ

#### 3. è°ƒç”¨å›¾ (`so_callgraph`) 
```python
so_callgraph(so_path, function_addr, max_depth=3)
# è¿”å›: è°ƒç”¨å…³ç³» + DOTæ ¼å¼å›¾
```
è¯†åˆ« BL/BLR æŒ‡ä»¤ï¼Œé€’å½’åˆ†æè°ƒç”¨å…³ç³»

#### 4. æ§åˆ¶æµå›¾ (`so_get_cfg`) 
```python
so_get_cfg(so_path, function_addr)
# è¿”å›: åŸºæœ¬å— + åˆ†æ”¯è¾¹ + DOTå›¾
```

#### 5. å…¨é¢å‡½æ•°åˆ†æ (`so_analyze_function_advanced`) 
```python
so_analyze_function_advanced(so_path, function_address, size=512)
# è¿”å›: è°ƒç”¨å…³ç³»ã€ç³»ç»Ÿè°ƒç”¨ã€å­—ç¬¦ä¸²å¼•ç”¨ã€å¤æ‚åº¦ã€ç±»å‹åˆ¤æ–­
```

### ä¼˜å…ˆçº§ 3 - å·²å®Œæˆ

#### 6. å­—ç¬¦ä¸²åŠ å¯†æ£€æµ‹ (`so_detect_encryption`) 
```python
so_detect_encryption(so_path)
# è¿”å›: é«˜ç†µå­—ç¬¦ä¸²ã€XORå¯†é’¥ã€Base64ç¼–ç ã€è§£å¯†å‡½æ•°æç¤º
```

#### 7. æ•°æ®æµåˆ†æ (`so_trace_register`) 
```python
so_trace_register(so_path, function_addr, register="x0")
# è¿”å›: å¯„å­˜å™¨å€¼æ¥æºã€æ•°æ®æµã€è¿”å›å€¼åˆ†æ
```

### å¾…å®ç° (ä½ä¼˜å…ˆçº§)

#### 8. æŒ‡ä»¤æ¨¡å¼æœç´¢
```python
so_find_instruction_pattern(so_path, pattern="mov.*bl")
```

#### 9. ç±»å‹ç³»ç»Ÿ (7ä¸ªå·¥å…·)
- å¯¹äº SO æ–‡ä»¶åˆ†æä¸å¤ªé‡è¦

#### 10. è°ƒè¯•å™¨ (13ä¸ªå·¥å…·)
- å»ºè®®ä¸å®ç°ï¼ŒIDA Pro çš„è°ƒè¯•å™¨æ›´å¼ºå¤§

---

## æˆ‘ä»¬ç‹¬æœ‰çš„ä¼˜åŠ¿ 

### Flutter è‡ªåŠ¨åŒ–å·¥å…·é“¾
```
1. flutter_detect â†’ æ£€æµ‹Flutteråº”ç”¨
2. flutter_ssl_offset_v2 â†’ æ™ºèƒ½å®šä½SSLå‡½æ•°
3. flutter_patch_ssl â†’ Patch SOæ–‡ä»¶
4. flutter_patch_apk â†’ ä¸€é”®Patch APK
5. apk_sign â†’ ç­¾åAPK
6. adb_install â†’ å®‰è£…åˆ°è®¾å¤‡
```

**IDA Pro MCP å®Œå…¨æ²¡æœ‰è¿™äº›åŠŸèƒ½ï¼**

### APK æ“ä½œèƒ½åŠ›
```
- so_list_libs â†’ åˆ—å‡ºAPKä¸­çš„åº“
- so_extract â†’ æå–SOæ–‡ä»¶
- flutter_patch_apk â†’ ä¿®æ”¹å¹¶é‡æ–°æ‰“åŒ…
```

**IDA Pro MCP åªèƒ½åˆ†æï¼Œä¸èƒ½æ“ä½œ APKï¼**

---

## å»ºè®®å®ç°çš„å·¥å…·ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰

### ğŸ”´ å¿…é¡»å®ç° (æ ¸å¿ƒç¼ºå¤±)

#### 1. `so_decompile` - åç¼–è¯‘
```python
{
  "name": "so_decompile",
  "description": "åç¼–è¯‘å‡½æ•°ç”Ÿæˆä¼ªä»£ç ï¼ˆä½¿ç”¨Ghidraï¼‰",
  "inputSchema": {
    "so_path": "SOæ–‡ä»¶è·¯å¾„",
    "address": "å‡½æ•°åœ°å€",
    "lines": "è¿”å›çš„ä»£ç è¡Œæ•°ï¼ˆé»˜è®¤50ï¼‰"
  }
}
```

**å®ç°æ–¹å¼**: é›†æˆ Ghidra Headless
**å·¥ä½œé‡**: 2-3å¤©
**ä»·å€¼**: â­â­â­â­â­

#### 2. `so_list_all_functions` - åˆ—å‡ºæ‰€æœ‰å‡½æ•°
```python
{
  "name": "so_list_all_functions",
  "description": "è¯†åˆ«æ‰€æœ‰å‡½æ•°ï¼ˆåŒ…æ‹¬æœªå¯¼å‡ºçš„ï¼‰",
  "inputSchema": {
    "so_path": "SOæ–‡ä»¶è·¯å¾„",
    "filter": "è¿‡æ»¤æ¨¡å¼ï¼ˆå¯é€‰ï¼‰",
    "limit": "æœ€å¤šè¿”å›æ•°é‡"
  }
}
```

**å®ç°æ–¹å¼**: æ‰«æ .text æ®µï¼Œè¯†åˆ«å‡½æ•°å¼€å¤´æ¨¡å¼
**å·¥ä½œé‡**: 1-2å¤©
**ä»·å€¼**: â­â­â­â­

### ğŸŸ¡ å»ºè®®å®ç° (å¢å¼ºåŠŸèƒ½)

#### 3. `so_callees` - è·å–è¢«è°ƒç”¨å‡½æ•°
```python
{
  "name": "so_callees",
  "description": "è·å–å‡½æ•°è°ƒç”¨çš„æ‰€æœ‰å‡½æ•°",
  "inputSchema": {
    "so_path": "SOæ–‡ä»¶è·¯å¾„",
    "function_addr": "å‡½æ•°åœ°å€"
  }
}
```

**å·¥ä½œé‡**: 2å¤©
**ä»·å€¼**: â­â­â­

#### 4. `so_callers` - è·å–è°ƒç”¨è€…
```python
{
  "name": "so_callers",
  "description": "è·å–è°ƒç”¨æ­¤å‡½æ•°çš„æ‰€æœ‰å‡½æ•°",
  "inputSchema": {
    "so_path": "SOæ–‡ä»¶è·¯å¾„",
    "function_addr": "å‡½æ•°åœ°å€"
  }
}
```

**å·¥ä½œé‡**: 2å¤©
**ä»·å€¼**: â­â­â­

#### 5. `so_callgraph` - è°ƒç”¨å›¾
```python
{
  "name": "so_callgraph",
  "description": "æ„å»ºå‡½æ•°è°ƒç”¨å›¾",
  "inputSchema": {
    "so_path": "SOæ–‡ä»¶è·¯å¾„",
    "root_addr": "èµ·å§‹å‡½æ•°åœ°å€",
    "max_depth": "æœ€å¤§æ·±åº¦ï¼ˆé»˜è®¤3ï¼‰"
  }
}
```

**å·¥ä½œé‡**: 3å¤©
**ä»·å€¼**: â­â­â­

#### 6. `so_find_instruction_pattern` - æŒ‡ä»¤æ¨¡å¼æœç´¢
```python
{
  "name": "so_find_instruction_pattern",
  "description": "æœç´¢æŒ‡ä»¤åºåˆ—æ¨¡å¼",
  "inputSchema": {
    "so_path": "SOæ–‡ä»¶è·¯å¾„",
    "pattern": "æŒ‡ä»¤æ¨¡å¼ï¼ˆå¦‚ 'mov.*bl'ï¼‰",
    "limit": "æœ€å¤šè¿”å›æ•°é‡"
  }
}
```

**å·¥ä½œé‡**: 2å¤©
**ä»·å€¼**: â­â­

#### 7. `so_basic_blocks` - åŸºæœ¬å—åˆ†æ
```python
{
  "name": "so_basic_blocks",
  "description": "è·å–å‡½æ•°çš„æ§åˆ¶æµå›¾åŸºæœ¬å—",
  "inputSchema": {
    "so_path": "SOæ–‡ä»¶è·¯å¾„",
    "function_addr": "å‡½æ•°åœ°å€"
  }
}
```

**å·¥ä½œé‡**: 3å¤©
**ä»·å€¼**: â­â­

### ğŸŸ¢ å¯é€‰å®ç° (ä½ä¼˜å…ˆçº§)

#### 8. `so_get_entrypoints` - è·å–å…¥å£ç‚¹
```python
{
  "name": "so_get_entrypoints",
  "description": "è·å–SOæ–‡ä»¶çš„å…¥å£ç‚¹",
  "inputSchema": {
    "so_path": "SOæ–‡ä»¶è·¯å¾„"
  }
}
```

**å·¥ä½œé‡**: 0.5å¤©
**ä»·å€¼**: â­

#### 9. `so_list_globals` - åˆ—å‡ºå…¨å±€å˜é‡
```python
{
  "name": "so_list_globals",
  "description": "åˆ—å‡ºå…¨å±€å˜é‡",
  "inputSchema": {
    "so_path": "SOæ–‡ä»¶è·¯å¾„",
    "filter": "è¿‡æ»¤æ¨¡å¼"
  }
}
```

**å·¥ä½œé‡**: 1å¤©
**ä»·å€¼**: â­

---

## å®ç°ä¼˜å…ˆçº§å»ºè®®

### ç¬¬ä¸€æ‰¹ (1-2å‘¨) - æ ¸å¿ƒåŠŸèƒ½
1. âœ… `so_decompile` - åç¼–è¯‘ (æœ€é‡è¦)
2. âœ… `so_list_all_functions` - å‡½æ•°è¯†åˆ«

### ç¬¬äºŒæ‰¹ (2-3å‘¨) - å¢å¼ºåŠŸèƒ½
3. âœ… `so_callees` - è¢«è°ƒç”¨å‡½æ•°
4. âœ… `so_callers` - è°ƒç”¨è€…
5. âœ… `so_callgraph` - è°ƒç”¨å›¾

### ç¬¬ä¸‰æ‰¹ (3-4å‘¨) - é«˜çº§åŠŸèƒ½
6. â¬œ `so_find_instruction_pattern` - æŒ‡ä»¤æœç´¢
7. â¬œ `so_basic_blocks` - åŸºæœ¬å—åˆ†æ

### ä¸å»ºè®®å®ç°
- âŒ è°ƒè¯•å™¨åŠŸèƒ½ (13ä¸ª) - IDA Pro æ›´å¥½
- âŒ ç±»å‹ç³»ç»Ÿ (7ä¸ª) - å¯¹ SO åˆ†æä»·å€¼ä¸å¤§
- âŒ æ³¨é‡Š/é‡å‘½å - ä¸æ˜¯ MCP å·¥å…·çš„æ ¸å¿ƒéœ€æ±‚

---

## æ€»ç»“

### å½“å‰çŠ¶æ€
- **å·²æœ‰å·¥å…·**: 30ä¸ª
- **IDAç‹¬æœ‰**: 15ä¸ª (ä¸»è¦æ˜¯è°ƒè¯•å™¨å’Œç±»å‹ç³»ç»Ÿ)
- **æˆ‘ä»¬ç‹¬æœ‰**: 13ä¸ª (Flutterä¸“ç”¨ + åŠ å¯†æ£€æµ‹)

### å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½ âœ…
1. **åç¼–è¯‘** - æ”¯æŒ radare2/Ghidra/è½»é‡çº§æ¨¡å¼ âœ…
2. **å‡½æ•°è¯†åˆ«** - è¯†åˆ«æ‰€æœ‰å‡½æ•°åŒ…æ‹¬æœªå¯¼å‡º âœ…
3. **è°ƒç”¨å›¾åˆ†æ** - DOTæ ¼å¼è¾“å‡º âœ…
4. **æ§åˆ¶æµå›¾** - åŸºæœ¬å—åˆ†æ âœ…
5. **å­—ç¬¦ä¸²åŠ å¯†æ£€æµ‹** - ç†µå€¼åˆ†æ âœ…
6. **æ•°æ®æµåˆ†æ** - å¯„å­˜å™¨è¿½è¸ª âœ…

### ç‹¬ç‰¹ä¼˜åŠ¿
1. **Flutter è‡ªåŠ¨åŒ–** - IDA å®Œå…¨æ²¡æœ‰ â­
2. **APK æ“ä½œ** - IDA å®Œå…¨æ²¡æœ‰ â­
3. **ä¸€é”® Patch** - IDA éœ€è¦æ‰‹åŠ¨ â­
4. **å…è´¹å¼€æº** - IDA Pro éœ€è¦ $1000+ â­

### ç»“è®º
**so-analyzer-mcp å·²ç»æ˜¯ Flutter é€†å‘çš„æœ€ä½³å…è´¹å·¥å…·ï¼**